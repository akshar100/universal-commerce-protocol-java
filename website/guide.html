<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Guide - UCP Java</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=Fira+Code&display=swap"
        rel="stylesheet">
</head>

<body>
    <header>
        <div class="nav-container">
            <a href="index.html" class="logo">UCP Java</a>
            <nav class="nav-links">
                <a href="index.html">Home</a>
                <a href="guide.html" class="active">User Guide</a>
                <a href="api.html">API Reference</a>
                <a href="javadocs/index.html">Javadocs</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <h1>User Guide</h1>

        <h2>Installation</h2>
        <p>Add the starter to your project. Ensure you are using Spring Boot 3.2+ and Java 17+.</p>
        <pre><code>// build.gradle
dependencies {
    implementation 'dev.ucomprotocol:ucp-spring-boot-starter:1.0.0'
}</code></pre>

        <h2>Configuration</h2>
        <p>Configure the library using standard Spring Boot properties in <code>application.properties</code> or
            <code>application.yml</code>.
        </p>

        <pre><code># Default to mock provider for testing
ucp.provider=mock

# Example: Shopify Configuration (Future)
# ucp.provider=shopify
# ucp.endpoint=https://my-store.myshopify.com
# ucp.api-key=shpat_xxxxxxxx</code></pre>

        <h2>Using the Adapters</h2>
        <p>Inject the <code>CommerceAdapter</code> bean into your services. This bean automatically resolves to the
            correct implementation based on your configuration.</p>

        <h3>Searching Products</h3>
        <pre><code>@Autowired
private CommerceAdapter commerceAdapter;

public List&lt;Product&gt; search(String term) {
    return commerceAdapter.getCatalogAdapter().searchProducts(term);
}</code></pre>

        <h3>Managing Carts</h3>
        <pre><code>public Cart createCartForUser(String userId) {
    return commerceAdapter.getCartAdapter().createCart(userId);
}</code></pre>

        <h2>Discovery Endpoint</h2>
        <p>One of the key features of UCP Java is the <strong>Automatic Discovery Endpoint</strong>. This allows clients
            to query your service and discover which capabilities it supports (e.g., does it support Carts? Orders?).
        </p>

        <h3>How to Enable</h3>
        <p>To enable the <code>/.well-known/ucp</code> endpoint, you simply need to include the Spring Boot Web starter
            alongside UCP Java. The library detects if you are running a web application and automatically registers the
            controller.</p>
        <pre><code>// build.gradle
dependencies {
    // 1. Add UCP Java
    implementation 'dev.ucomprotocol:ucp-spring-boot-starter:1.0.0'
    
    // 2. Ensure you have the Web Starter (Discovery only works in web apps)
    implementation 'org.springframework.boot:spring-boot-starter-web'
}</code></pre>

        <h3>Verification</h3>
        <p>Once your application starts, you can verify the endpoint is active using <code>curl</code>:</p>
        <pre><code>curl http://localhost:8080/.well-known/ucp</code></pre>

        <p><strong>Response Example:</strong></p>
        <pre><code>GET /.well-known/ucp
{
  "ucp": {
    "version": "2026-01-23",
    "capabilities": {
      "dev.ucp.shopping.catalog": [
         { "version": "2026-01-23", "spec": "..." }
      ],
      "dev.ucp.shopping.cart": [ ... ],
      "dev.ucp.shopping.order": [ ... ],
      "dev.ucp.common.identity": [ ... ]
    }
  }
}</code></pre>
        <p>This response tells you:</p>
        <ul>
            <li><strong>Protocol Version</strong>: 2026-01-23</li>
            <li><strong>Capabilities</strong>: A map of supported capabilities and their details.</li>
        </ul>

        <h3>Changing Providers</h3>
        <p>To return a different provider in the discovery info, simply change your configuration in
            <code>application.properties</code>:
        </p>
        <pre><code>ucp.provider=shopify</code></pre>
        <p>The endpoint will use the Shopify adapter to determine capabilities.</p>

        <h2>Custom Adapters</h2>
        <p>To implement your own adapter, simply implement the `CommerceAdapter` interface and register it as a Spring
            Bean. The auto-configuration will back off and use your bean instead.</p>

        <pre><code>@Configuration
public class MyCommerceConfig {
    @Bean
    public CommerceAdapter myCustomAdapter() {
        return new MyCustomCommerceAdapter();
    }
}</code></pre>

        <h3>Defining Capabilities</h3>
        <p>The Discovery Endpoint automatically detects which capabilities your adapter supports. It does this by
            checking which methods return `null`.</p>
        <p>For example, if you only support the **Catalog**, you can implement your adapter like this:</p>
        <pre><code>public class ReadOnlyCommerceAdapter implements CommerceAdapter {
    
    @Override
    public CatalogAdapter getCatalogAdapter() {
        return new MyCatalogAdapter(); // Supported
    }

    @Override
    public CartAdapter getCartAdapter() {
        return null; // Not Supported
    }

    @Override
    public OrderAdapter getOrderAdapter() {
        return null; // Not Supported
    }

    @Override
    public CustomerAdapter getCustomerAdapter() {
        return null; // Not Supported
    }
}</code></pre>
        <p>When you query the discovery endpoint, it will correctly report:</p>
        <pre><code>{
  "ucp": {
    "version": "2026-01-23",
    "capabilities": {
      "dev.ucp.shopping.catalog": [ ... ]
    }
  }
}</code></pre>

    </main>

    <footer>
        <p>&copy; 2026 UCP Java. Built for developers. <a href="https://ucp.dev/latest/">Official Documentation</a></p>
    </footer>
</body>

</html>